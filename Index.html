<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      /* Basic styling for the form */
      form {
        max-width: 565px;
        margin: 0 auto;
        padding: 15px;
        border: 1px solid Silver;
        border-radius: 5px;
        background-color: Gainsboro;
      }
      label, select, input {
        display: block;
        margin-bottom: 0px;
        width: 100%;
        -webkit-box-sizing: border-box;
        box-sizing: content-box; /* compatibility */
      }
      select, input, div {
        font-family: 'Courier New', Courier, monospace;
        font-size: medium;
      }
      h1, h3, label, input[type="submit"], text {
        font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      }
      text {
        font-size: smaller;
        font-style: italic;
        color: darkgrey;
      }
      div {
        text-align: center;
        color: #000;
      }
      div[id="search"], div[id="settings"] {
        text-align: left;
        padding-top: 10px;
        padding-left: 15px;
        padding-right: 15px;
        border: 1px solid Silver;
        border-radius: 5px;
        background-color: #F8F8F8;
      }
      text[id="search"], text[id="settings"] {
        font-style: normal;
      }
      input[type="submit"] {
        background-color: white;
        border-color: Silver;
        color: black;
        border-radius: 5px;
      }
    </style>
  </head>
  <body>
    <h1><center>Update 加油 ("jiā yóu") Events</center></h1>
    <h3><center><font style="color: orange;">CAUTION: Event details will be overwritten.</font></center></h3>
    <form id="calendarForm">

      <div id="search">

        <text id="search"><center>Search Parameters</center></text>
        </br>

        <label for="calendarName">Calendar name:</label>
        <input type="text" id="calendarName" name="calendarName" value="JIA YOU" required>
        <!-- Must name it differently from the owner name -->
        </br>

        <label for="query">Query:</label>
        <input type="text" id="query" name="query" value="New Meeting" required>
        <text>Event you want to update</text>
        <!-- Query ignores any extra spacing -->
        <!-- prefilled for clarity -->
        </br></br>

        <label for="queryAdd">Additional query:</label>
        <input type="text" id="queryAdd" name="queryAdd" value="J Day" placeholder="Optional">
        <text>Confine your search</text>
        <!-- Query ignores any extra spacing -->
        <!-- Input query to confine search -->
        <!-- prefilled for clarity -->
        </br></br>

        <label for="start">Start date:</label>
        <input type="text" id="start" name="start" placeholder="Optional"></input>
        <!-- Confine date range -->
        <text>Accepted formats: Mmm DD YYYY; MM/DD/YYYY; DD Mmm YYYY</text>
        </br></br>

        <label for="end">End date:</label>
        <input type="text" id="end" name="end" placeholder="Optional"></input>
        <!-- Confine date range -->
        <text>Accepted formats: Mmm DD YYYY; MM/DD/YYYY; DD Mmm YYYY</text>
        </br></br>

      </div>

      </br>

      <div id="settings">

        <text id="settings"><center>Event Settings</center></text>
        </br>

        <label for="title">Title:</label>
        <input type="text" id="title" name="title" value="Updated Meeting" required>
        <!-- prefilled for convenience -->
        </br>

        <label for="location">Location:</label>
        <input type="text" id="location" name="location" placeholder="Optional">
        </br>

        <label for="description">Description:</label>
        <input type="text" id="description" name="description"  placeholder="Optional">
        <text>Accepted formats: string or URL</text>
        </br></br>

        <label for="startTime">Start time:</label>
        <input type="text" id="startTime" name="startTime" value="9:00" required></input>
        <!-- prefilled for clarity -->
        <text>Accepted format: 24-hour</text>
        </br></br>

        <label for="endTime">End time:</label>
        <input type="text" id="endTime" name="endTime" value="10:00" required></input>
        <!-- prefilled for clarity -->
        <text>Accepted format: 24-hour</text>
        </br></br>

      </div>

      </br>

      <input type="submit" value="Submit">
      <div id="wait">&nbsp;</div>
    </form>
    
    <script>
      // JavaScript handles form submission and sends data to the Google Apps Script
      document.getElementById('calendarForm').addEventListener('submit', function(event) {
        event.preventDefault(); // Prevents the form from submitting the traditional way

        var calendarName = document.getElementById('calendarName').value;
        var query = document.getElementById('query').value;
        var queryAdd = document.getElementById('queryAdd').value;
        var start = document.getElementById('start').value;
        var end = document.getElementById('end').value;

        var title = document.getElementById('title').value;
        var location = document.getElementById('location').value;
        var description = document.getElementById('description').value;
        var startTime = document.getElementById('startTime').value;
        var endTime = document.getElementById('endTime').value;
        
        document.getElementById("wait").innerHTML = "Please wait...";

        google.script.run.withSuccessHandler(function(response) {
          document.getElementById('wait').innerHTML = response; // Displays a success message when completed
        }).updateEvents(calendarName, query, queryAdd, start, end, title, location, description, startTime, endTime);
      });
    </script>
  </body>
</html>